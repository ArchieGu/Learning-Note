# 面向对象分析 (OOA)

面对不明确的需求，应先从最简单的方案想起，然后再优化（MVP 最小可行性产品思想）。第一轮基础分析，应先搞清基础概念，之后了解最佳时间并进行技术调研。之后的每一轮，逐步迭代改进，在每一轮中都应给出一个可行的解决方案，并在此基础上进行优化。

# 面向对象设计(OOD)

面向对象分析的产出是详细的需求描述，面向对象设计的产出就是类【将需求描述转化为具体的类的设计】。

1. 划分职责进而识别出有哪些类
2. 定义类及其属性和方法
3. 定义类与类之间的交互关系
4. 将类组装起来并提供执行入口

## 划分职责进而识别类

简单做法：将需求描述中的名词罗列出来作为可能的候选类，然后再进行筛选。

稍微好点儿的做法：根据需求描述，把其中涉及的功能点罗列出来【拆解出来的每个功能点要尽可能的小（单一职责）】，然后再分析哪些功能点职责相近，操作同样的属性，可否应该归为同一个类。

但如果是复杂系统，根据需求罗列功能点，会得到超长列表、凌乱且没有规律。

针对复杂的需求开发，首先需要做的是**模块划分**，将需求简单划分为几个小的、独立的功能模块，然后再在模块内部，应用上述方法。

## 定义类及其属性和方法

如何识别出方法：识别出需求描述中的动词，作为候选的方法，再进一步过滤筛选。功能点中涉及的名词，作为属性候选，然后再进行过滤筛选。

> ***Note:*** 
>
> 1. 不是所有出现的名词都会被定义为类的属性，有些名词也会被用作方法的参数
> 2. 挖掘没有出现在功能点描述中的属性，例如createTime(), expireTimeInterval等，两个结合起来，可以用来判断token、数据是否过期等需求。
> 3. 添加一些一定会用到，但在需求中没有明确提出的方法

从业务模型上看，不属于这个类的属性和方法就不要放到这个类中。在设计类的方法和属性的时候，也不能完全依赖**当下的**需求，需要分析从业务模型上来说，理应有哪些属性和方法，保障类定义的完整性，也能为未来的需求做准备。

## 定义类与类之间的交互关系

### 泛化(Generalization)

即继承关系

```java
public class A {...}
public class B extends A {...}
```

### 实现(Realization)

一般指接口和实现类之间的关系

```java
public interface A {...}
public class B implements A {...}
```

### 聚合(Aggregation)

一种包含关系，A类对象包含B类对象，B类对象的生命周期可以不依赖 A 类对象的生命周期，也就是说可以单独销毁 A 类对象而不影响 B 对象，比如课程与学生之间的关系。

```java
public class A {
	private B b;
	public A(B b) {
		this.b = b;
	}
}
```

### 组合(Composition)

一种包含关系，A 类对象包含 B 类对象，B 类对象的生命周期跟依赖 A 类对象的生命周期，B 类对象不可单独存在，比如鸟与翅膀之间的关系。

```java
public class A {
	private B b;
	public A() {
		this.b = new B();
	}
}
```

### 关联 (Association)

弱关系，包含聚合、组合两种关系。具体到代码层面，如果 B 类对象是 A 类的成员变量，那 B 类和 A 类就是关联关系。

```java
public class A {
	private B b;
	public A(B b) {
		this.b = b;
	}
}
// 或者
public class A {
	private B b;
	public A() {
		this.b = new B();
	}
}

```

### 依赖 (Dependency)

一种比关联关系更加弱的关系，包含关联关系。不管是 B 类对象是 A 类对象的成员变量，还是 A 类的方法使用 B 类对象作为参数或者返回值、局部变量，只要 B 类对象和 A 类对象有任何使用关系，我们都称它们有依赖关系。

```java
public class A {
	private B b;
	public A(B b) {
		this.b = b;
	}
}
// 或者
public class A {
	private B b;
	public A() {
		this.b = new B();
	}
}
// 或者
public class A {
	public void func(B b) { ... }
}
```

## 将类组装起来并提供执行入口

将所有的类组装在一起，提供一个执行入口。入口可以是main()函数，也可以是一组给外部用的 API 接口。通过这个入口，能触发让整个代码跑起来。